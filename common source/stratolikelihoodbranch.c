double stratlikelihoodbranch(double fa, double origin, double *r, double *vr){int a, b, c, d;double	t;double	x, y, z;double	divisions[4];double L=0.0f, lnL=0.0f;a=fa;			/* observed first appearance	*/b=origin;		/* hypothesized origin			*//* these are the divisions of a normal curve giving midpoints of 4 equal area units	*/divisions[0]=-1.150349380;divisions[1]=-0.318639364;divisions[2]=0.318639364;divisions[3]=1.150349380;/* go through each bin (c) from first appearance (a) to hypothesized origin (b)	*/for (c=a; c>=b; --c)	{	if (c==a && c>b)		t=fa-((double) c);			/* take into account partial presence in last "stage"	*/	else if (c==b && c<a)		t=((double) c)-origin;		/* take into account partial presence in first "stage"	*/	else if (a==b)		t=fa-origin;				/* take into account partial presence in only "stage"	*/	else		t=1.0f;						/* presence in whole "stage"	*/	L=0.0f;	for (d=0; d<4; ++d)	{		x=pow(vr[c],divisions[d]);	/* rate modifier at this point of lognormal	*/		y=x*r[c];					/* modified rate							*/		z=y*t;						/* expected finds							*/		L+=pow(e,-z);				/* probability of 0 finds at this rate		*/		}	L/=4;			/* take into account our 1 in 4 priors on the different preservation rates	*/	lnL+=log(L);	/* log it	*/	}return lnL;}