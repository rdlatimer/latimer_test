/* first date branches	*/for (c=nodes-1; c>=0; --c)	{	fa[notu+c]=ranges[tree[c][1]][0];	for (b=2; b<=tree[c][0]; ++b)	{		sp=tree[c][b];		if (ranges[sp][0]<fa[notu+c])	fa[notu+c]=ranges[sp][0];		}	if (trpd[tree[c][1]==0)	{		anc=1;		a=tree[c][1];		}	else						anc=0;	fa[tree[c][1]]=fa[notu+c];	for (b=2; b<=tree[c][0]; ++b)	{		s=tree[c][b];		if (fa[s]!=-1)	{			/* if the ancestor is present, then fa is first appearance OR last appearance of ancestor	*/			if (anc==1)	fa[s]=imin((int) ranges[s][0],(int) ranges[a],1);			/* if the ancestor is absent, then fa is age of node appearance OR last appearance of ancestor	*/			else		fa[s]=imin((int) ranges[s][0],(int) ranges[a],1);				}	}	